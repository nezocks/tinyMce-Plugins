/**
 * TinyMCE version 6.7.0 (2023-08-30)
 */
tinymce.PluginManager.add("shortcodes",function(t){function e(e){!function t(e){let $=document.createElement("input");$.style.position="absolute",$.style.left="-9999px",$.value=e,document.body.appendChild($),$.select();try{document.execCommand("copy"),_(`Шорткод ${e} скопійовано!`,"info")}catch{_("Копіювання не вдалося!","error")}document.body.removeChild($)}(e);let $=t.getContainer().querySelector(".tox-tbtn.tox-tbtn--enabled");$&&$.click()}function _(e,_){t.notificationManager.open({text:e,type:_,timeout:2e3})}t.ui.registry.addIcon("shortcodes",'<svg width="24px" height="24px" viewBox="0 0 17 17"><path d="M0.026 1h3v1h-2v13h2v1h-3v-15zM14.026 1v1h2v13h-2v1h3v-15h-3zM8.91 7.967c-1.115-0.433-1.607-0.804-1.607-1.56 0-0.552 0.42-1.211 1.523-1.211 0.731 0 1.271 0.239 1.535 0.384l0.288-0.852c-0.359-0.204-0.96-0.396-1.787-0.396-1.571 0-2.614 0.936-2.614 2.195 0 1.14 0.815 1.823 2.135 2.291 1.091 0.419 1.523 0.851 1.523 1.606 0 0.815-0.624 1.38-1.691 1.38-0.72 0-1.403-0.24-1.871-0.528l-0.264 0.876c0.432 0.287 1.283 0.516 2.062 0.516 1.907 0 2.831-1.079 2.831-2.327 0.001-1.188-0.696-1.847-2.063-2.374z" fill="#000000" /></svg>'),t.ui.registry.addMenuButton("shortcodes",{icon:"shortcodes",tooltip:"Шорткоди",fetch:function($){let o=t.getElement().getAttribute("data-shortcodes"),n=t.getElement().getAttribute("data-shortcodes-url");if(!o&&!n)return _("Шорткоди не знайдено","error"),$([]);o?function t($,o){try{let n=JSON.parse($).map(({key:t,name:_})=>({type:"menuitem",text:`${_} - ${t}`,onAction:()=>e(t)}));o(n)}catch(r){_("Шорткоди не знайдено","error"),o([])}}(o,$):function t($,o){fetch($).then(t=>t.json()).then(t=>{o(t.shortcodes.map(({key:t,name:_})=>({type:"menuitem",text:`${_} - ${t}`,onAction:()=>e(t)})))}).catch(t=>{_("Помилка: "+t.message,"error"),o([])})}(n,$)}})});


// tinymce.PluginManager.add('shortcodes', function(editor) {
//     editor.ui.registry.addIcon('shortcodes', '<svg width="24px" height="24px" viewBox="0 0 17 17"><path d="M0.026 1h3v1h-2v13h2v1h-3v-15zM14.026 1v1h2v13h-2v1h3v-15h-3zM8.91 7.967c-1.115-0.433-1.607-0.804-1.607-1.56 0-0.552 0.42-1.211 1.523-1.211 0.731 0 1.271 0.239 1.535 0.384l0.288-0.852c-0.359-0.204-0.96-0.396-1.787-0.396-1.571 0-2.614 0.936-2.614 2.195 0 1.14 0.815 1.823 2.135 2.291 1.091 0.419 1.523 0.851 1.523 1.606 0 0.815-0.624 1.38-1.691 1.38-0.72 0-1.403-0.24-1.871-0.528l-0.264 0.876c0.432 0.287 1.283 0.516 2.062 0.516 1.907 0 2.831-1.079 2.831-2.327 0.001-1.188-0.696-1.847-2.063-2.374z" fill="#000000" /></svg>');
//
//     editor.ui.registry.addMenuButton('shortcodes', {
//         icon: 'shortcodes',
//         tooltip: 'Шорткоди',
//         fetch: function(callback) {
//             const shortcodesAttr = editor.getElement().getAttribute('data-shortcodes');
//             const shortcodesSuggestUrl = editor.getElement().getAttribute('data-shortcodes-url');
//
//             if (!shortcodesAttr && !shortcodesSuggestUrl) {
//                 notify('Шорткоди не знайдено', 'error');
//                 return callback([]);
//             }
//
//             if (shortcodesAttr) {
//                 processShortcodes(shortcodesAttr, callback);
//             } else {
//                 fetchShortcodes(shortcodesSuggestUrl, callback);
//             }
//         }
//     });
//
//     function processShortcodes(attr, callback) {
//         try {
//             let items = JSON.parse(attr).map(({ key, name }) => ({
//                 type: 'menuitem',
//                 text: `${name} - ${key}`,
//                 onAction: () => handleShortcodeAction(key)
//             }));
//             callback(items);
//         } catch (error) {
//             notify('Шорткоди не знайдено', 'error');
//             callback([]);
//         }
//     }
//
//     function fetchShortcodes(url, callback) {
//         fetch(url)
//             .then(response => response.json())
//             .then(result => {
//                 let items = result.shortcodes.map(({ key, name }) => ({
//                     type: 'menuitem',
//                     text: `${name} - ${key}`,
//                     onAction: () => handleShortcodeAction(key)
//                 }));
//                 callback(items);
//             })
//             .catch(error => {
//                 notify('Помилка: ' + error.message, 'error');
//                 callback([]);
//             });
//     }
//
//     function handleShortcodeAction(key) {
//         copyToClipboard(key);
//         const button = editor.getContainer().querySelector('.tox-tbtn.tox-tbtn--enabled');
//         if (button) button.click();
//     }
//
//     function copyToClipboard(text) {
//         const tempInput = document.createElement('input');
//         tempInput.style.position = 'absolute';
//         tempInput.style.left = '-9999px';
//         tempInput.value = text;
//         document.body.appendChild(tempInput);
//         tempInput.select();
//         try {
//             document.execCommand('copy');
//             notify(`Шорткод ${text} скопійовано!`, 'info');
//         } catch {
//             notify('Копіювання не вдалося!', 'error');
//         }
//         document.body.removeChild(tempInput);
//     }
//
//     function notify(message, type) {
//         editor.notificationManager.open({
//             text: message,
//             type: type,
//             timeout: 2000
//         });
//     }
// });
